# Database Schema Documentation
*Generated by Antigravity Hook: Schema Tracker*
*Last Updated: 2026-02-13*

## Enums

| Enum Name | Values |
|---|---|
| `user_status` | active, suspended, deleted, pending_verification |
| `role_name` | artist, band_manager, promoter, organizer, venue_manager, admin, staff |
| `booking_status` | inquiry, offered, negotiating, contracting, confirmed, paid_deposit, scheduled, completed, cancelled, disputed, refunded |
| `contract_status` | draft, sent, signed_by_promoter, signed_by_artist, admin_review, signed, voided, completed |
| `payment_status` | initiated, authorized, captured, failed, refunded, cancelled |
| `payout_status` | queued, processing, paid, failed, cancelled |

## Tables

### `users`
Core user table for authentication and basic profile info.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| username | text | unique | |
| email | text | notNull, unique | |
| passwordHash | text | | |
| displayName | text | | |
| status | user_status | default: pending_verification | |
| metadata | jsonb | default: {} | |

### `artists`
Artist profiles linked to users.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| userId | integer | FK `users.id` | |
| name | text | notNull | Stage name |
| isBand | boolean | default: false | |
| bio | text | | |
| baseLocation | jsonb | | |
| priceFrom | numeric | | |
| priceTo | numeric | | |
| metadata | jsonb | default: {} | Contains genre, social links, etc. |

### `promoters` (Aliased as `organizers`)
Event organizer profiles.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| userId | integer | FK `users.id` | |
| organizationId | integer | FK `organizations.id` | |
| name | text | | |
| contactPerson | jsonb | | |

### `venues`
Venue profiles.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| userId | integer | FK `users.id` | |
| name | text | notNull | |
| address | jsonb | | |
| capacity | integer | | |
| amenities | jsonb | | |

### `events`
Events created by organizers/venues.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| organizerId | integer | FK `promoters.id` | |
| venueId | integer | FK `venues.id` | |
| title | text | notNull | |
| startTime | timestamp | notNull | |
| status | text | default: "draft" | |

### `bookings`
Bookings of artists for events.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| eventId | integer | FK `events.id` | |
| artistId | integer | FK `artists.id` | |
| status | booking_status | default: "inquiry" | |
| offerAmount | numeric | | |
| finalAmount | numeric | | |

### `contracts`
Legal contracts for bookings.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| bookingId | integer | FK `bookings.id` | |
| status | contract_status | default: "draft" | |
| signedByPromoter | boolean | | |
| signedByArtist | boolean | | |

### `payments`
Inbound payments from users/organizers.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| bookingId | integer | FK `bookings.id` | |
| amount | numeric | notNull | |
| status | payment_status | default: "initiated" | |

### `payouts`
Outbound payments to artists/users.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| toUserId | integer | FK `users.id` | |
| amount | numeric | notNull | |
| status | payout_status | default: "queued" | |

### `media`
File uploads and media assets.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| ownerUserId | integer | FK `users.id` | |
| entityType | text | | artist, event, etc. |
| entityId | integer | | |
| data | text | | URL or storage ref |

### `notifications`
User notifications.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | serial | PK | |
| userId | integer | FK `users.id` | |
| channel | notification_channel | | |
| body | text | | |

### `audit_logs`
System audit trail.

| Column | Type | Constraints | Description |
|---|---|---|---|
| id | bigserial | PK | |
| who | integer | FK `users.id` | |
| action | text | notNull | |
| diff | jsonb | | Changes made |
